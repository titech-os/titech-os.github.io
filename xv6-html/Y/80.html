<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>dp</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.5' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/22.html#L511'>dp</a>                511 fs.c           dirlookup(struct inode *dp, char *name, uint *poff)</span>
<span class='curline'><a href='../S/22.html#L516'>dp</a>                516 fs.c             if(dp-&gt;type != T_DIR)</span>
<span class='curline'><a href='../S/22.html#L519'>dp</a>                519 fs.c             for(off = 0; off &lt; dp-&gt;size; off += sizeof(de)){</span>
<span class='curline'><a href='../S/22.html#L520'>dp</a>                520 fs.c               if(readi(dp, (char*)&amp;de, off, sizeof(de)) != sizeof(de))</span>
<span class='curline'><a href='../S/22.html#L529'>dp</a>                529 fs.c                 return iget(dp-&gt;dev, inum);</span>
<span class='curline'><a href='../S/22.html#L538'>dp</a>                538 fs.c           dirlink(struct inode *dp, char *name, uint inum)</span>
<span class='curline'><a href='../S/22.html#L545'>dp</a>                545 fs.c             if((ip = dirlookup(dp, name, 0)) != 0){</span>
<span class='curline'><a href='../S/22.html#L551'>dp</a>                551 fs.c             for(off = 0; off &lt; dp-&gt;size; off += sizeof(de)){</span>
<span class='curline'><a href='../S/22.html#L552'>dp</a>                552 fs.c               if(readi(dp, (char*)&amp;de, off, sizeof(de)) != sizeof(de))</span>
<span class='curline'><a href='../S/22.html#L560'>dp</a>                560 fs.c             if(writei(dp, (char*)&amp;de, off, sizeof(de)) != sizeof(de))</span>
<span class='curline'><a href='../S/80.html#L121'>dp</a>                121 sysfile.c        struct inode *dp, *ip;</span>
<span class='curline'><a href='../S/80.html#L143'>dp</a>                143 sysfile.c        if((dp = nameiparent(new, name)) == 0)</span>
<span class='curline'><a href='../S/80.html#L145'>dp</a>                145 sysfile.c        ilock(dp);</span>
<span class='curline'><a href='../S/80.html#L146'>dp</a>                146 sysfile.c        if(dp-&gt;dev != ip-&gt;dev || dirlink(dp, name, ip-&gt;inum) &lt; 0){</span>
<span class='curline'><a href='../S/80.html#L147'>dp</a>                147 sysfile.c          iunlockput(dp);</span>
<span class='curline'><a href='../S/80.html#L150'>dp</a>                150 sysfile.c        iunlockput(dp);</span>
<span class='curline'><a href='../S/80.html#L168'>dp</a>                168 sysfile.c      isdirempty(struct inode *dp)</span>
<span class='curline'><a href='../S/80.html#L173'>dp</a>                173 sysfile.c        for(off=2*sizeof(de); off&lt;dp-&gt;size; off+=sizeof(de)){</span>
<span class='curline'><a href='../S/80.html#L174'>dp</a>                174 sysfile.c          if(readi(dp, (char*)&amp;de, off, sizeof(de)) != sizeof(de))</span>
<span class='curline'><a href='../S/80.html#L186'>dp</a>                186 sysfile.c        struct inode *ip, *dp;</span>
<span class='curline'><a href='../S/80.html#L195'>dp</a>                195 sysfile.c        if((dp = nameiparent(path, name)) == 0){</span>
<span class='curline'><a href='../S/80.html#L200'>dp</a>                200 sysfile.c        ilock(dp);</span>
<span class='curline'><a href='../S/80.html#L206'>dp</a>                206 sysfile.c        if((ip = dirlookup(dp, name, &amp;off)) == 0)</span>
<span class='curline'><a href='../S/80.html#L218'>dp</a>                218 sysfile.c        if(writei(dp, (char*)&amp;de, off, sizeof(de)) != sizeof(de))</span>
<span class='curline'><a href='../S/80.html#L221'>dp</a>                221 sysfile.c          dp-&gt;nlink--;</span>
<span class='curline'><a href='../S/80.html#L222'>dp</a>                222 sysfile.c          iupdate(dp);</span>
<span class='curline'><a href='../S/80.html#L224'>dp</a>                224 sysfile.c        iunlockput(dp);</span>
<span class='curline'><a href='../S/80.html#L235'>dp</a>                235 sysfile.c        iunlockput(dp);</span>
<span class='curline'><a href='../S/80.html#L244'>dp</a>                244 sysfile.c        struct inode *ip, *dp;</span>
<span class='curline'><a href='../S/80.html#L247'>dp</a>                247 sysfile.c        if((dp = nameiparent(path, name)) == 0)</span>
<span class='curline'><a href='../S/80.html#L249'>dp</a>                249 sysfile.c        ilock(dp);</span>
<span class='curline'><a href='../S/80.html#L251'>dp</a>                251 sysfile.c        if((ip = dirlookup(dp, name, &amp;off)) != 0){</span>
<span class='curline'><a href='../S/80.html#L252'>dp</a>                252 sysfile.c          iunlockput(dp);</span>
<span class='curline'><a href='../S/80.html#L260'>dp</a>                260 sysfile.c        if((ip = ialloc(dp-&gt;dev, type)) == 0)</span>
<span class='curline'><a href='../S/80.html#L270'>dp</a>                270 sysfile.c          dp-&gt;nlink++;  // for ".."</span>
<span class='curline'><a href='../S/80.html#L271'>dp</a>                271 sysfile.c          iupdate(dp);</span>
<span class='curline'><a href='../S/80.html#L273'>dp</a>                273 sysfile.c          if(dirlink(ip, ".", ip-&gt;inum) &lt; 0 || dirlink(ip, "..", dp-&gt;inum) &lt; 0)</span>
<span class='curline'><a href='../S/80.html#L277'>dp</a>                277 sysfile.c        if(dirlink(dp, name, ip-&gt;inum) &lt; 0)</span>
<span class='curline'><a href='../S/80.html#L280'>dp</a>                280 sysfile.c        iunlockput(dp);</span>
</pre>
</body>
</html>
