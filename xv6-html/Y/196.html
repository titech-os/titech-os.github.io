<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>lh</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.1' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/38.html#L45'>lh</a>                 45 log.c            struct logheader lh;</span>
<span class='curline'><a href='../S/38.html#L73'>lh</a>                 73 log.c            for (tail = 0; tail &lt; log.lh.n; tail++) {</span>
<span class='curline'><a href='../S/38.html#L75'>lh</a>                 75 log.c              struct buf *dbuf = bread(log.dev, log.lh.block[tail]); // read dst</span>
<span class='curline'><a href='../S/38.html#L88'>lh</a>                 88 log.c            struct logheader *lh = (struct logheader *) (buf-&gt;data);</span>
<span class='curline'><a href='../S/38.html#L90'>lh</a>                 90 log.c            log.lh.n = lh-&gt;n;</span>
<span class='curline'><a href='../S/38.html#L91'>lh</a>                 91 log.c            for (i = 0; i &lt; log.lh.n; i++) {</span>
<span class='curline'><a href='../S/38.html#L92'>lh</a>                 92 log.c              log.lh.block[i] = lh-&gt;block[i];</span>
<span class='curline'><a href='../S/38.html#L106'>lh</a>                106 log.c            hb-&gt;n = log.lh.n;</span>
<span class='curline'><a href='../S/38.html#L107'>lh</a>                107 log.c            for (i = 0; i &lt; log.lh.n; i++) {</span>
<span class='curline'><a href='../S/38.html#L108'>lh</a>                108 log.c              hb-&gt;block[i] = log.lh.block[i];</span>
<span class='curline'><a href='../S/38.html#L119'>lh</a>                119 log.c            log.lh.n = 0;</span>
<span class='curline'><a href='../S/38.html#L131'>lh</a>                131 log.c              } else if(log.lh.n + (log.outstanding+1)*MAXOPBLOCKS &gt; LOGSIZE){</span>
<span class='curline'><a href='../S/38.html#L179'>lh</a>                179 log.c            for (tail = 0; tail &lt; log.lh.n; tail++) {</span>
<span class='curline'><a href='../S/38.html#L181'>lh</a>                181 log.c              struct buf *from = bread(log.dev, log.lh.block[tail]); // cache block</span>
<span class='curline'><a href='../S/38.html#L192'>lh</a>                192 log.c            if (log.lh.n &gt; 0) {</span>
<span class='curline'><a href='../S/38.html#L196'>lh</a>                196 log.c              log.lh.n = 0; </span>
<span class='curline'><a href='../S/38.html#L215'>lh</a>                215 log.c            if (log.lh.n &gt;= LOGSIZE || log.lh.n &gt;= log.size - 1)</span>
<span class='curline'><a href='../S/38.html#L221'>lh</a>                221 log.c            for (i = 0; i &lt; log.lh.n; i++) {</span>
<span class='curline'><a href='../S/38.html#L222'>lh</a>                222 log.c              if (log.lh.block[i] == b-&gt;blockno)   // log absorbtion</span>
<span class='curline'><a href='../S/38.html#L225'>lh</a>                225 log.c            log.lh.block[i] = b-&gt;blockno;</span>
<span class='curline'><a href='../S/38.html#L226'>lh</a>                226 log.c            if (i == log.lh.n)</span>
<span class='curline'><a href='../S/38.html#L227'>lh</a>                227 log.c              log.lh.n++;</span>
</pre>
</body>
</html>
