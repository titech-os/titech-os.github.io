<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>dp</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.6.2' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/46.html#L526'>dp</a>                526 fs.c           dirlookup(struct inode *dp, char *name, uint *poff)</span>
<span class='curline'><a href='../S/46.html#L531'>dp</a>                531 fs.c             if(dp-&gt;type != T_DIR)</span>
<span class='curline'><a href='../S/46.html#L534'>dp</a>                534 fs.c             for(off = 0; off &lt; dp-&gt;size; off += sizeof(de)){</span>
<span class='curline'><a href='../S/46.html#L535'>dp</a>                535 fs.c               if(readi(dp, (char*)&amp;de, off, sizeof(de)) != sizeof(de))</span>
<span class='curline'><a href='../S/46.html#L544'>dp</a>                544 fs.c                 return iget(dp-&gt;dev, inum);</span>
<span class='curline'><a href='../S/46.html#L553'>dp</a>                553 fs.c           dirlink(struct inode *dp, char *name, uint inum)</span>
<span class='curline'><a href='../S/46.html#L560'>dp</a>                560 fs.c             if((ip = dirlookup(dp, name, 0)) != 0){</span>
<span class='curline'><a href='../S/46.html#L566'>dp</a>                566 fs.c             for(off = 0; off &lt; dp-&gt;size; off += sizeof(de)){</span>
<span class='curline'><a href='../S/46.html#L567'>dp</a>                567 fs.c               if(readi(dp, (char*)&amp;de, off, sizeof(de)) != sizeof(de))</span>
<span class='curline'><a href='../S/46.html#L575'>dp</a>                575 fs.c             if(writei(dp, (char*)&amp;de, off, sizeof(de)) != sizeof(de))</span>
<span class='curline'><a href='../S/31.html#L122'>dp</a>                122 sysfile.c        struct inode *dp, *ip;</span>
<span class='curline'><a href='../S/31.html#L144'>dp</a>                144 sysfile.c        if((dp = nameiparent(new, name)) == 0)</span>
<span class='curline'><a href='../S/31.html#L146'>dp</a>                146 sysfile.c        ilock(dp);</span>
<span class='curline'><a href='../S/31.html#L147'>dp</a>                147 sysfile.c        if(dp-&gt;dev != ip-&gt;dev || dirlink(dp, name, ip-&gt;inum) &lt; 0){</span>
<span class='curline'><a href='../S/31.html#L148'>dp</a>                148 sysfile.c          iunlockput(dp);</span>
<span class='curline'><a href='../S/31.html#L151'>dp</a>                151 sysfile.c        iunlockput(dp);</span>
<span class='curline'><a href='../S/31.html#L169'>dp</a>                169 sysfile.c      isdirempty(struct inode *dp)</span>
<span class='curline'><a href='../S/31.html#L174'>dp</a>                174 sysfile.c        for(off=2*sizeof(de); off&lt;dp-&gt;size; off+=sizeof(de)){</span>
<span class='curline'><a href='../S/31.html#L175'>dp</a>                175 sysfile.c          if(readi(dp, (char*)&amp;de, off, sizeof(de)) != sizeof(de))</span>
<span class='curline'><a href='../S/31.html#L187'>dp</a>                187 sysfile.c        struct inode *ip, *dp;</span>
<span class='curline'><a href='../S/31.html#L196'>dp</a>                196 sysfile.c        if((dp = nameiparent(path, name)) == 0){</span>
<span class='curline'><a href='../S/31.html#L201'>dp</a>                201 sysfile.c        ilock(dp);</span>
<span class='curline'><a href='../S/31.html#L207'>dp</a>                207 sysfile.c        if((ip = dirlookup(dp, name, &amp;off)) == 0)</span>
<span class='curline'><a href='../S/31.html#L219'>dp</a>                219 sysfile.c        if(writei(dp, (char*)&amp;de, off, sizeof(de)) != sizeof(de))</span>
<span class='curline'><a href='../S/31.html#L222'>dp</a>                222 sysfile.c          dp-&gt;nlink--;</span>
<span class='curline'><a href='../S/31.html#L223'>dp</a>                223 sysfile.c          iupdate(dp);</span>
<span class='curline'><a href='../S/31.html#L225'>dp</a>                225 sysfile.c        iunlockput(dp);</span>
<span class='curline'><a href='../S/31.html#L236'>dp</a>                236 sysfile.c        iunlockput(dp);</span>
<span class='curline'><a href='../S/31.html#L245'>dp</a>                245 sysfile.c        struct inode *ip, *dp;</span>
<span class='curline'><a href='../S/31.html#L248'>dp</a>                248 sysfile.c        if((dp = nameiparent(path, name)) == 0)</span>
<span class='curline'><a href='../S/31.html#L250'>dp</a>                250 sysfile.c        ilock(dp);</span>
<span class='curline'><a href='../S/31.html#L252'>dp</a>                252 sysfile.c        if((ip = dirlookup(dp, name, &amp;off)) != 0){</span>
<span class='curline'><a href='../S/31.html#L253'>dp</a>                253 sysfile.c          iunlockput(dp);</span>
<span class='curline'><a href='../S/31.html#L261'>dp</a>                261 sysfile.c        if((ip = ialloc(dp-&gt;dev, type)) == 0)</span>
<span class='curline'><a href='../S/31.html#L271'>dp</a>                271 sysfile.c          dp-&gt;nlink++;  // for ".."</span>
<span class='curline'><a href='../S/31.html#L272'>dp</a>                272 sysfile.c          iupdate(dp);</span>
<span class='curline'><a href='../S/31.html#L274'>dp</a>                274 sysfile.c          if(dirlink(ip, ".", ip-&gt;inum) &lt; 0 || dirlink(ip, "..", dp-&gt;inum) &lt; 0)</span>
<span class='curline'><a href='../S/31.html#L278'>dp</a>                278 sysfile.c        if(dirlink(dp, name, ip-&gt;inum) &lt; 0)</span>
<span class='curline'><a href='../S/31.html#L281'>dp</a>                281 sysfile.c        iunlockput(dp);</span>
</pre>
</body>
</html>
